{
    "variables": {
      "name": "{{env `AMI_NAME`}}",
      "subnet_id": "{{env `SUBNET_ID`}}",
      "access_key": "{{env `ACCESS_KEY`}}",
      "secret_key": "{{env `SECRET_KEY`}}"
    },
    "sensitive-variables": ["access_key", "secret_key"],
    "builders": [{
      "type": "amazon-ebs",
      "access_key": "{{user `access_key`}}",
      "secret_key":"{{user `secret_key`}}",
      "ami_name": "{{user `name`}}",
      "region": "us-east-1",
      "instance_type": "t2.micro",
      "ssh_username": "centos",
      "subnet_id": "{{user `subnet_id`}}",
      "run_tags": {
        "Name": "{{user `name`}}"
      },
      "tags": {
        "OS_Version": "CentOS 7 (x86_64)",
        "Base_AMI_Name": "{{ .SourceAMIName }}"
      },
      "source_ami_filter": {
        "filters": {
          "owner-alias": "aws-marketplace",
          "product-code": "aw0evgkw8e5c1q413zgy5pjce",
          "virtualization-type": "hvm"
        },
        "owners": ["aws-marketplace"],
        "most_recent": true
      }
    }],
    "provisioners": [
        {
          "type": "ansible",
          "playbook_file": "../nginx-ansible/run.yaml",
          "sftp_command": "/usr/libexec/openssh/sftp-server -e"
        }
      ]
  }
